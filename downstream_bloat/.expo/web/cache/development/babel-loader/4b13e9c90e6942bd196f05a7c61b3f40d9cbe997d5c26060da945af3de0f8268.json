{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport React, { useState } from \"react\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"../../components/Text\";\nimport Button from \"../../components/Button\";\nimport Card from \"../../components/Card\";\nimport { styles } from \"./Entry.style\";\nimport { LoginFields, RegisterFields } from \"./Entry.model.\";\nimport { Theme } from \"../../models/theme\";\nimport { useUpstream } from \"../../contexts/GrpcContext\";\nimport { LoginRequest, RegisterRequest } from \"../../models/proto/auth\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Tabs = {\n  Login: {\n    title: \"Login\",\n    fields: LoginFields\n  },\n  Register: {\n    title: \"Register\",\n    fields: RegisterFields\n  }\n};\nexport default function Entry(_ref) {\n  var navigation = _ref.navigation;\n  var _useUpstream = useUpstream(),\n    login = _useUpstream.login,\n    register = _useUpstream.register;\n  var _useState = useState(Tabs.Login.title),\n    _useState2 = _slicedToArray(_useState, 2),\n    activeTab = _useState2[0],\n    setActiveTab = _useState2[1];\n  var _useState3 = useState({}),\n    _useState4 = _slicedToArray(_useState3, 2),\n    fields = _useState4[0],\n    setFields = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    formError = _useState6[0],\n    setFormError = _useState6[1];\n  function getMissingFields() {\n    return Object.keys(Tabs[activeTab].fields).reduce(function (acc, key) {\n      return !fields[key] ? [].concat(_toConsumableArray(acc), [key]) : acc;\n    }, []);\n  }\n  function onSubmit() {\n    return _onSubmit.apply(this, arguments);\n  }\n  function _onSubmit() {\n    _onSubmit = _asyncToGenerator(function* () {\n      var missingFields = getMissingFields();\n      if (missingFields.length > 0) {\n        setFormError(\"Missing fields: \" + missingFields.join(\", \"));\n        return;\n      }\n      var base = {\n        email: fields.Email,\n        password: fields.Password\n      };\n      try {\n        if (activeTab === Tabs.Login.title) {\n          yield login(LoginRequest.create(base));\n        } else {\n          register(RegisterRequest.create(_objectSpread(_objectSpread({}, base), {}, {\n            fullName: fields.Name,\n            displayName: fields.DisplayName\n          })));\n        }\n        navi;\n      } catch (e) {\n        setFormError(e.message);\n      }\n    });\n    return _onSubmit.apply(this, arguments);\n  }\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsxs(Card, {\n      style: styles.form,\n      children: [_jsx(View, {\n        style: _objectSpread(_objectSpread({}, styles.tabs), {}, {\n          borderBottomColor: Theme.colors.buttonSecondary,\n          paddingBottom: Theme.spacing.md,\n          borderBottomWidth: 2\n        }),\n        children: Object.values(Tabs).map(function (_ref2) {\n          var title = _ref2.title;\n          return _jsx(Button, {\n            onPress: function onPress() {\n              setActiveTab(title);\n              setFields({});\n            },\n            color: activeTab === title ? Theme.colors.button : Theme.colors.buttonSecondary,\n            style: {\n              flex: 1,\n              borderRadius: 0\n            },\n            children: _jsx(Text, {\n              children: title\n            })\n          });\n        })\n      }), _jsx(View, {\n        style: styles.formFieldContainer,\n        children: Object.entries(Tabs[activeTab].fields).map(function (_ref3) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n            key = _ref4[0],\n            _ref4$ = _ref4[1],\n            label = _ref4$.label,\n            type = _ref4$.type;\n          return _jsxs(View, {\n            style: styles.formField,\n            children: [_jsx(Text, {\n              children: label\n            }), _jsx(TextInput, {\n              onChange: function onChange(event) {\n                setFields(_objectSpread(_objectSpread({}, fields), {}, _defineProperty({}, key, event.nativeEvent.text)));\n              },\n              secureTextEntry: type === \"password\",\n              style: styles.input\n            })]\n          }, key);\n        })\n      }), _jsx(View, {\n        style: {\n          borderTopColor: Theme.colors.buttonSecondary,\n          paddingTop: Theme.spacing.md,\n          borderTopWidth: 2\n        },\n        children: _jsx(Button, {\n          onPress: function onPress() {},\n          disabled: getMissingFields.length !== 0,\n          children: _jsx(Text, {\n            children: \"Submit\"\n          })\n        })\n      })]\n    })\n  });\n}","map":{"version":3,"names":["React","useState","TextInput","View","Text","Button","Card","styles","LoginFields","RegisterFields","Theme","useUpstream","LoginRequest","RegisterRequest","jsx","_jsx","jsxs","_jsxs","Tabs","Login","title","fields","Register","Entry","_ref","navigation","_useUpstream","login","register","_useState","_useState2","_slicedToArray","activeTab","setActiveTab","_useState3","_useState4","setFields","_useState5","_useState6","formError","setFormError","getMissingFields","Object","keys","reduce","acc","key","concat","_toConsumableArray","onSubmit","_onSubmit","apply","arguments","_asyncToGenerator","missingFields","length","join","base","email","Email","password","Password","create","_objectSpread","fullName","Name","displayName","DisplayName","navi","e","message","style","container","children","form","tabs","borderBottomColor","colors","buttonSecondary","paddingBottom","spacing","md","borderBottomWidth","values","map","_ref2","onPress","color","button","flex","borderRadius","formFieldContainer","entries","_ref3","_ref4","_ref4$","label","type","formField","onChange","event","_defineProperty","nativeEvent","text","secureTextEntry","input","borderTopColor","paddingTop","borderTopWidth","disabled"],"sources":["/Users/matthewkelley/Desktop/cutchin-cash/downstream/views/Entry/Entry.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { TextInput, View } from \"react-native\";\nimport Text from \"../../components/Text\";\nimport Button from \"../../components/Button\";\nimport Card from \"../../components/Card\";\nimport { styles } from \"./Entry.style\";\nimport { LoginFields, RegisterFields } from \"./Entry.model.\";\nimport { Theme } from \"../../models/theme\";\nimport { useUpstream } from \"../../contexts/GrpcContext\";\nimport { LoginRequest, RegisterRequest } from \"../../models/proto/auth\";\nimport { NativeStackScreenProps } from \"@react-navigation/native-stack\";\n\ntype Tab = keyof typeof Tabs;\n\nconst Tabs = {\n  Login: {\n    title: \"Login\",\n    fields: LoginFields,\n  },\n  Register: {\n    title: \"Register\",\n    fields: RegisterFields,\n  },\n} as const;\n\nexport default function Entry({ navigation }: NativeStackScreenProps<any>) {\n  const { login, register } = useUpstream();\n  const [activeTab, setActiveTab] = useState<Tab>(Tabs.Login.title);\n  const [fields, setFields] = useState<Record<string, string>>({});\n  const [formError, setFormError] = useState<string | null>(null);\n\n  function getMissingFields(): string[] {\n    return Object.keys(Tabs[activeTab].fields).reduce((acc, key) => {\n      return !fields[key] ? [...acc, key] : acc;\n    }, [] as string[]);\n  }\n\n  async function onSubmit() {\n    const missingFields = getMissingFields();\n    if (missingFields.length > 0) {\n      setFormError(`Missing fields: ${missingFields.join(\", \")}`);\n      return;\n    }\n    const base = {\n      email: fields.Email,\n      password: fields.Password,\n    };\n\n    try {\n      if (activeTab === Tabs.Login.title) {\n        await login(LoginRequest.create(base));\n      } else {\n        register(\n          RegisterRequest.create({\n            ...base,\n            fullName: fields.Name,\n            displayName: fields.DisplayName,\n          })\n        );\n      }\n      navi;\n    } catch (e) {\n      setFormError(e.message);\n    }\n  }\n\n  return (\n    <View style={styles.container}>\n      <Card style={styles.form}>\n        {/* Tabs */}\n        <View\n          style={{\n            ...styles.tabs,\n            borderBottomColor: Theme.colors.buttonSecondary,\n            paddingBottom: Theme.spacing.md,\n            borderBottomWidth: 2,\n          }}\n        >\n          {Object.values(Tabs).map(({ title }) => (\n            <Button\n              onPress={() => {\n                setActiveTab(title);\n                setFields({});\n              }}\n              color={\n                activeTab === title\n                  ? Theme.colors.button\n                  : Theme.colors.buttonSecondary\n              }\n              style={{\n                flex: 1,\n                borderRadius: 0,\n              }}\n            >\n              <Text>{title}</Text>\n            </Button>\n          ))}\n        </View>\n\n        {/* Fields */}\n        <View style={styles.formFieldContainer}>\n          {Object.entries(Tabs[activeTab].fields).map(\n            ([key, { label, type }]) => (\n              <View key={key} style={styles.formField}>\n                <Text>{label}</Text>\n                <TextInput\n                  onChange={(event) => {\n                    setFields({\n                      ...fields,\n                      [key]: event.nativeEvent.text,\n                    });\n                  }}\n                  secureTextEntry={type === \"password\"}\n                  style={styles.input}\n                />\n              </View>\n            )\n          )}\n        </View>\n\n        {/* Submit */}\n        <View\n          style={{\n            borderTopColor: Theme.colors.buttonSecondary,\n            paddingTop: Theme.spacing.md,\n            borderTopWidth: 2,\n          }}\n        >\n          <Button onPress={() => {}} disabled={getMissingFields.length !== 0}>\n            <Text>Submit</Text>\n          </Button>\n        </View>\n      </Card>\n    </View>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}